<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      lang="en" xml:lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Ocean Eddies Web Viewer</title>
  <style type="text/css">
    html, body { margin: 0; padding: 0; height: 100%; }
    #topwrapper, #vcentwrapper
      { margin: 0px; padding: 0px; position: absolute; width: 100%; }
    #topwrapper { height: 2in; top: 0px; background-color: #a0b0ff; }
    #vcentwrapper { top: 2in; bottom: 0px; background-color: #3240a0; }
    #hcentwrapper { margin: 0px 6px 0px 6px; padding: 0px;
                    width: auto; height: 100%; position: relative;
                    background-color: #229944;
                    overflow: hidden; }
    #sidewrapper { float: right; margin: 0px 6px 0px 6px; padding: 0px;
                   width: 30%; max-width: 3in; height: 100%; position: relative;
                   background-color: #77ff77; }

    #topbar { margin: 6px; overflow: auto; }
    #sidebar, #drawingContainer { margin-bottom: 6px; }
    #topbar, #sidebar, #drawingContainer
      { padding: 6px;
        position: absolute; top: 0px; bottom: 0px; left: 0px; right: 0px;
        color: white; background-color: #333348; border: solid black;
        text-align: center; }
    #drawingContainer { padding: 0px; overflow: hidden; }
    #sidebar { overflow: auto; }

    .coldiv { display: inline-block; vertical-align: top; padding: 8px;
             /* border-style: solid; border-color: black; */
             text-align: right; }
    .solocoldiv { text-align: right; }
    /* input, select { color: white; background-color: gray; } */
    .numinput { width: 4em; }
    .wideinput { width: auto; }
  </style>
  <script type="text/javascript"
	  src="../canvas_globe_test/globe_render.js"></script>
  <script type="text/javascript">
  <!--//--><![CDATA[//><!--

function initGUIHooks() {
  document.getElementById('cfg-projMethod').onchange = function(event) {
    var choice = this.options[this.selectedIndex].text;
    if (choice == 'Perspective') {
      persp_project = true;
      equirect_project = false;

      var zoomCtl = document.getElementById('cfg-scaleFac');
      zoomCtl.setAttribute('disabled', true); // Needed for Firefox.
      zoomCtl.disabled = true; // Needed for older versions of IE.

      var fovCtl = document.getElementById('cfg-perspFOV');
      fovCtl.setAttribute('disabled', false);
      fovCtl.disabled = false;

      var altCtl = document.getElementById('cfg-perspAltitude');
      altCtl.setAttribute('disabled', false);
      altCtl.disabled = false;

    } else if (choice == 'Equirectangular') {
      persp_project = false;
      equirect_project = true;
    } else {
      persp_project = false;
      equirect_project = false;
    }

    if (choice != 'Perspective') {
      var zoomCtl = document.getElementById('cfg-scaleFac');
      zoomCtl.setAttribute('disabled', false); // Needed for Firefox.
      zoomCtl.disabled = false; // Needed for older versions of IE.

      var fovCtl = document.getElementById('cfg-perspFOV');
      fovCtl.setAttribute('disabled', true);
      fovCtl.disabled = true;

      var altCtl = document.getElementById('cfg-perspAltitude');
      altCtl.setAttribute('disabled', true);
      altCtl.disabled = true;
    }

    render_globe();
  };

/* TODO: When "refresh" is hit on the browser, some browsers preserve
   the previous form values in the controls.  Ideally, we should get
   the initial values from all the controls on startup.  */

  document.getElementById('cfg-scaleFac').onchange = function(event) {
    scale = +this.value; // Convert string to float
    render_globe();
  };

  document.getElementById('cfg-perspAltitude').onchange = function(event) {
    persp_altitude = +this.value;
    render_globe();
  };

  document.getElementById('cfg-perspFOV').onchange = function(event) {
    persp_fov = +this.value;
    render_globe();
  };

  document.getElementById('cfg-latLon').onchange = function(event) {
    var parts = this.value.split(' ');
    tilt = +parts[0];
    lon_rot = (+parts[2]) + 180;
    render_globe();
  };

  document.getElementById('cfg-landMass').onchange = function(event) {
    var choice = this.options[this.selectedIndex].text;
    if (choice == 'Textured')
      render_land_tex = true;
    else
      render_land_tex = false;
    refreshOverlay();
    render_globe();
  };

  document.getElementById('cfg-sshPal').onchange = function(event) {
    var choice = this.options[this.selectedIndex].text;
    if (choice == 'MATLAB')
      render_ssh = true;
    else if (choice == 'None')
      render_ssh = false;
    refreshOverlay();
    render_globe();
  };

  document.getElementById('cfg-lenRange').onchange = function(event) {
    var parts = this.value.split(', ');
    min_track_len = +parts[0];
    if (parts[1] == 'max')
      max_track_len = -1;
    else
      max_track_len = +parts[1];
    renderEddyTracks();
    refreshOverlay();
    render_globe();
  };

  document.getElementById('cfg-osaFactor').onchange = function(event) {
    osa_factor = ~~(+this.value);
    inv_osa_factor = 1 / osa_factor;
    render_globe();
  };

  document.getElementById('cfg-gridDensity').onchange = function(event) {
    var parts = this.value.split(', ');
    grat_density = +parts[0];
    render_globe();
  };

  document.getElementById('cfg-wireRender').onclick = function(event) {
    if (this.checked)
      wire_render = true;
    else
      wire_render = false;
    render_globe();
  };

  document.getElementById('cfg-dateSel').onchange = function(event) {
    dateIndex = this.selectedIndex;
    renderEddyTracks();
    refreshOverlay();
    render_globe();
  };

  document.getElementById('cfg-datePrev').onclick = function(event) {
    dateIndex--;
    document.getElementById('cfg-dateSel').selectedIndex = dateIndex;
    renderEddyTracks();
    refreshOverlay();
    render_globe();
  };

  document.getElementById('cfg-dateNext').onclick = function(event) {
    dateIndex++;
    document.getElementById('cfg-dateSel').selectedIndex = dateIndex;
    renderEddyTracks();
    refreshOverlay();
    render_globe();
  };
}

  //--><!]]>
  </script>
</head>
<body onload="initCTModule(); initGUIHooks()">

<noscript>
<div style="margin: 0.5em">

<h1>Sorry</h1>

<p>You need a JavaScript-enabled web browser to use the the
interactive web viewer.</p>

<p>If you can see anything below the following line, then please
ignore it, since it will be unusable to you.</p>

<hr />
</div>
</noscript>

<div id="scriptWrapper" style="display: none">
<script type="text/javascript">
<!--//--><![CDATA[//><!--
document.getElementById('scriptWrapper').style.cssText = '';
//--><!]]>
</script>

<div id="topwrapper">
  <div id="topbar">
    <form action="">
      <div class="coldiv">
	<label for="cfg-landMass">Land Mass Background:</label>
	<select id="cfg-landMass">
	  <option>None</option>
	  <option>Silhouettes</option>
	  <option selected="selected">Textured</option>
	</select><br />
	<label for="cfg-sshPal">Sea Surface Height Palette:</label>
	<select id="cfg-sshPal">
	  <option>None</option>
	  <option selected="selected">MATLAB</option>
	  <option>Waters</option>
	  <option>Hatches</option>
	</select><br />
	<label for="cfg-projMethod">Earth Projection:</label>
	<select id="cfg-projMethod">
	  <option>Equirectangular</option>
	  <option>Mercator</option>
	  <option selected="selected">Orthographic</option>
	  <option>Perspective</option>
	</select><br />
	<fieldset>
	  <legend style="text-align: left">Graticule</legend>
	  <label for="cfg-gridDensity">Latitude, Longitude:</label>
	  <input id="cfg-gridDensity" type="text" value="15, 15"
		 class="numinput" />
	  <label for="cfg-gridDensity">degrees/line</label><br />
	</fieldset>
      </div>
      <div class="coldiv">
	<label for="cfg-trackLWRatio">Eddy Track Length/Width Ratio</label>
	<input id="cfg-trackLWRatio" type="text" value="75"
	       class="numinput" /><br />
	<input id="cfg-wireRender" type="checkbox" />
	<label for="cfg-wireRender">Wireframe Render
	</label><br />
	<input id="cfg-landScroll" type="checkbox" />
	<label for="cfg-landScroll">Land Mass Outlines When Scrolling
	</label><br />
	<label for="cfg-osaFactor">Oversampling Factor:</label>
	<input id="cfg-osaFactor" type="text" value="1"
	       class="numinput" /><br />
	<label for="cfg-maxIter">Max. Contiguous Loop Iterations:</label>
	<input id="cfg-maxIter" type="text" value="1024" class="numinput" />
      </div>
    </form>
  </div>
</div>

<div id="vcentwrapper">
  <div id="sidewrapper">
    <div id="sidebar">
      <form action="">
	<div class="solocoldiv">
	  <fieldset>
	    <legend style="text-align: left">Projection Properties</legend>
	    <label for="cfg-scaleFac">Scale Factor:</label>
	    <input id="cfg-scaleFac" type="text" value="1.0"
		   class="numinput" /><br />
	    <label for="cfg-perspAltitude">Altitude:</label>
	    <input id="cfg-perspAltitude" type="text" value="35786"
		   disabled="disabled" class="numinput" />
	    <label for="cfg-perspAltitude">kilometers</label><br />
	    <label for="cfg-perspFOV">Field of View:</label>
	    <input id="cfg-perspFOV" type="text" value="17.5"
		   disabled="disabled" class="numinput" />
	    <label for="cfg-perspFOV">degrees</label><br />
	  </fieldset><br />

	  <label for="cfg-latLon">Latitude, Longitude (degrees):</label>
	  <input id="cfg-latLon" type="text" value="0 N 0 E" /><br />
	  <br />

	  <label for="cfg-curDate">Date:</label>
	  <input id="cfg-curDate" type="text"
		 style="width: 6em" />
	  <select id="cfg-dateSel">
	  </select><br />
	  <input id="cfg-dateBegin" type="button" value="&lt;&lt; Begin" />
	  <input id="cfg-datePrev" type="button" value="&lt; Prev" />
	  <input id="cfg-dateNext" type="button" value="Next &gt;" />
	  <input id="cfg-dateEnd" type="button" value="End &gt;&gt;" /><br />
	  <br />

	  <fieldset>
	    <legend style="text-align: left">Eddy Filters</legend>
	    <input id="cfg-showCyc" type="checkbox" />
	    <label for="cfg-showCyc">Cyclonic Eddies</label><br />
	    <input id="cfg-showAntiCyc" type="checkbox" />
	    <label for="cfg-showAntiCyc">Anticyclonic Eddies</label><br />
	    <input id="cfg-showChelton" type="checkbox" />
	    <label for="cfg-showChelton">Chelton Tracks</label><br />
	    <label for="cfg-lenRange">Length Range (min, max)</label>
	    <input id="cfg-lenRange" type="text" value="0, max"
		   class="wideinput" />
	    <label for="cfg-lenRange">weeks</label>
	  </fieldset><br />

	  <fieldset>
	    <legend style="text-align: left">Eddy Information</legend>
	    <label for="cfg-dispEID">Eddy ID:</label>
	    <input id="cfg-dispEID" type="text" readonly="readonly"
		   class="numinput" /><br />
	    <label for="cfg-dispLatLon">Latitude, Longitude:</label>
	    <input id="cfg-dispLatLon" type="text" readonly="readonly"
		   style="width: 6em" /><br />
	    <label for="cfg-dispAmplitude">Amplitude:</label>
	    <input id="cfg-dispAmplitude" type="text" readonly="readonly"
		   class="numinput" /><br />
	    <label for="cfg-dispArea">Area:</label>
	    <input id="cfg-dispArea" type="text" readonly="readonly"
		   class="numinput" /><br />
	    <label for="cfg-dispGSpeed">Geodesic Speed:</label>
	    <input id="cfg-dispGSpeed" type="text" readonly="readonly"
		   class="numinput" />
	  </fieldset>
	</div>
      </form>
    </div>
  </div>
  <div id="hcentwrapper">
    <div id="drawingContainer">

      <p id="loadingScreen" style="text-align: center">
	<object type="image/svg+xml" data="loading_composite.svg">
	  <img src="loading_composite.png" alt="Decorative Loading Icon." />
	</object><br />
	<strong>Loading</strong>
      </p>

    </div>
  </div>
</div>

</div> <!-- END scriptWrapper -->

</body>
</html>
