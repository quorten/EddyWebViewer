<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      lang="en" xml:lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>onprogress test page</title>
</head>
<body>
<script type="text/javascript">
body = document.getElementsByTagName('body')[0]
diagLine = document.createElement('p')
body.appendChild(diagLine)
okayToGo = false
httpRequest = new XMLHttpRequest();
/* NOTE: Though Firefox 3.6 supports onprogress, it comes with extreme
   overhead, simply due to the sheer number of onprogress events that
   Firefox sends to itself.  */
httpRequest.onprogress = function(event) {
  if (okayToGo)
    diagLine.innerHTML = 'Progress: ' +
      (event.loaded * 100 / event.total).toFixed(3) + '%';
  okayToGo = false
  // window.setTimeout(function() { okayToGo = true }, 100)
};
httpRequest.onreadystatechange = function(event) {
  if (httpRequest.readyState == 4 && httpRequest.status == 200) {
    var doneEl = document.createElement('p');
    doneEl.innerHTML = 'Done loading';
    body.appendChild(doneEl);
  }
}
httpRequest.open('GET', '../data/tracks/acyc_bu_tracks.json');
httpRequest.send()

window.onhashchange = function(event) { alert('New hash: ' + event.newURL) }
window.onhashchange = function(event) { alert('New hash: ' + window.location) }
window.onhashchange = function(event) { alert('New hash: ' + window.location.hash) }
</script>
</body>
</html>
