These notes are even more scratch style notes.

SVG export and animation helpers

----------------------------------------

Unix: CentOS: How do you disable gnome-ssh-askpass for command-line use?

unset SSH_ASKPASS

http://kartzontech.blogspot.com/2011/04/how-to-disable-gnome-ssh-askpass.html

Nice automation script, try this one out:

cd ~/EddyWebViewer
git archive master | ssh mako0042@flute.cs.umn.edu \
  'rm -rf .www/EddyWebViewer
   mkdir  .www/EddyWebViewer
   cd     .www/EddyWebViewer
   tar -x
   chmod -R o+r .
   chmod o+x `find . -type d`'

----------------------------------------

Off topic:

http://blog.stackoverflow.com/2014/05/podcast-59-hes-one-of-those-science-ists/?cb=1

Well, maybe sites like Wikipedia and Stack Overflow need to take a
more pedagogical approach with new users, with special existing users
to give them the time and patience that they need.

https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions_and_function_scope/Strict_mode?redirectlocale=en-US&redirectslug=JavaScript%2FReference%2FFunctions_and_function_scope%2FStrict_mode

Tickless kernels?  Well, it's somewhat of a trick: it only refers to
the kernel not requiring ticks under certain circumstances.  The
system as a whole still needs timing, of course.

http://randomascii.wordpress.com/2013/07/08/windows-timer-resolution-megawatts-wasted/
http://lwn.net/Articles/549580/

----------------------------------------

Google site:

https://sites.google.com/a/umn.edu/mako-eddy-web-viewer/

----------------------------------------

Questions answered.

Need two modes in the Eddy Web Viewer.

1. Watch tracks from day to day, see the tracks alpha fade in and fade
   out.  Follow an eddy, see how it changes until it vanishes.
   Boundary, track.

2. Visualize how the boundaries of the eddies change.

3. Click on an eddy, select it, get information, follow.

4. Focus in on a region, change color scale.

5. Advanced rendering attributes such as swirling eddies and hatches
   scale, probably not as important.

6. Like a database query, filter the eddies that are
   displayed.

7. Preferred format: whatever works fastest in the viewer.

8. Speed is critical.  Performance matters, monitor bandwidth
   requirements and limitations.

9. Web hosting?  Maybe move to Amazon Web Services, we'll figure that
   out later.

Important!  SSH data directory:
  /project/expeditions/eddies_project_data/web_viewer

keifenhe

Woodrow Keifenheim

So two modes: one to show eddies in motion, another to see eddies
static, then click on an eddy to get more information.  The first mode
is critical in importance, the second mode, not so much.

----------------------------------------

Questions to ask Woodrow and James:

* Data precision?  32-bit floating point SSH.  24-bit fixed point.
  +/- 32 before the decimal, after the decimal.  JPEG compression,
  video compression.

* Do you want your SSH pixels nice and square or do you prefer
  bilinear interpolation smoothing?

* Resolution?  1440x721 for the current SSH data.

* How do the smallest size eddy tracks compare with the SSH
  resolution?

* The Sea Surface Height data measures from the international date
  line, not the prime meridian?

* Do you want the dates to appear hyphenless in the GUI?

* The main cause of slowness in track rendering appears to be
  differences in how efficient browsers are when being commanded to
  draw a line on the canvas.  One way to stabilize performance across
  browsers is to do all line rasterization in JavaScript and use
  putImageData(), as is being done with the raytracing renderers.
  Question which I already know the answer to: How do you draw a line
  without dividing to compute the slope?

* Any seasonal variations observed with the eddies?

* Browser testing?  Emulators of mobile devices.

* What did Hung mean by "slow"?

* NOT using SVG.  SVG DOM performance is said to be very poor when
  working with a large number of nodes.  This will especially be true
  if each eddy DOM object has an event listener attached to it.
  Memory leaks could also become a problem.  However, I haven't tested
  with SVG on this many datapoints, so I don't have specific evidence
  for these assertions yet.

* Web hosting?  Where should the site officially reside?

* JavaScript development in the labs: node.js

* Features vs. solidness of design.

* Visualization?  Highlight track datapoints how?

* What about the other viewers people are using?  Hung's viewer too
  slow?

* License notices?  Code included from other projects include them.

* What's with that computer next to this one that seems not to
  work?

Things to say:

* Above average cross-browser compatibility and performance.
  Great new slim GUI, cothreading...

* Need to say /competitively exceed/.  Performance like jsperf
  and Browserscope.  Not mediocre like D3.js.

* C to JavaScript translator.

* In case the whole web app thing cannot deliver that great of
  performance, we'll have a native backup.

* Plus, I'll be using all of my best codebase tricks in the code.

* Draw a crosshair at the center?

Things for me to do:

* I need to be make sure I implement multiple rendering mechanisms.

* It seems that loading the large JSON data is okay.  That means
  that I should be able to safely move onto building the kd-trees.

* Number of required experiments in rendering mechanisms:

* Tracks: full loading single image (composite image tiles) render,
  partial loading via XMLHttpRequest seeking, caching, w/wo kd-tree.

* SSH:  single load single render, reduction tiles.

* Best way to specify which code paths to use?  Just use class
  properties, maybe possibly use a setter function.

* Consolidate compatibility code.

* Multiple color schemes on the SSH RenderLayer.

* Interlaced raytracer.

Answers:

* Format of the dates: with/without dashes/hyphens, either way,
  whatever looks better.

* SSH at international date line: yes, you may need to shift so that
  it looks more interesting to other people.

* License notices: just open-source, like MIT license.  Make sure to
  say your name that you made it, though.

* Web hosting: Look on your own, check out Amazon Web Services, Google
  App Engine, see what works the best from home.  Then maybe go into
  to ring they have downstairs and go through MSI, the point is to
  find out what works best from home.  On your own, try to look for
  what works well from home.  Like you're making a proposal.

* SSH resolution?  Will probably stay at 1440x720 for the whole
  project.  Not entirely necessary, an experienced person would be
  able to look at it and just tell if that's an eddy or not.

* JPEG compression?  Shouldn't be an issue to limit down the precision
  of the SSH datapoints.

* Eddies that twist around across only a few pixels?  Maybe hide them
  at the global scale, show them when you zoom in.

* No seasonal variations observed with eddies, except that the
  increasing size of the ice caps can limit the oceanspace available
  to the eddies.

* Node.js installed on MSI?  Go ask help.msi.umn.edu, cc both James
  and Kumar, tell them you're working on this open-source project,
  make sure everything is cc on they're behalf so that that can
  intervene and answer for your.  We're the largest user of MSI so
  they will be friendly.

* We should try to get it to a state for other users to just get up
  and on the software, and see what features may be useful.

* Don't concentrate too much on the mobile, might not get the same
  experience as on desktop.

* The SSH data isn't entirely necessary.  Maybe don't need to load it
  all.  So animation can be done with the tracks alone.

To Woody:

* Please store the length of the tracks within the tracks somehow.

* Maybe the rendering engine should precompute and store the lengths.

For me:

* I need to allow generating information on the URL when the user
  changes the projection, view, etc.

* Need to alpha in/out on the tracks.

* Only load the data when needed.

Provide control over manual/automatic sea surface height scaling.

First thing to ask James next time:

So how many other eddy viewers are there?

----------------------------------------

Pending questions:

* Can I get the polar ice caps and land mass masks separate from the
  SSH data?  This will help a lot since I need to maintain a division
  between lossy and lossless compressed data for the web viewer.  It
  will also help in that I will be able to draw the regions of the
  current polar ice caps as white on the Earth.

* FFMPEG on MSI?  We'll need a reliable way to convert the image
  frames to video data.  Video data will have the best performance
  since it will require the least HTTP requests.

* Chelton tracks?  No, we don't care about Chelton tracks at all
  anymore.

* Note the branch created to cleanup the git repository.  Hung's old
  viewer data causes the 6 of the 10 MB in the repo files.  I should
  be able to permanently delete the excess data files for this, too.

* Eddy ID, track ID, amplitude, area, geodesic speed?  These are going
  to have to be gotten from elsewhere.

Now, things are winding down:

* NOTE: I need to handle eddies that span across the 360 mark
  specially so that a line is not drawn traversing the entire map.

* My location widget is broken.  It needs to be corrected for the
  current projection.

* Verify all my code is "use strict" safe.

* Get the new code to work in Internet Explorer.

* I need to do many things.

* Step forward and step backward

* Display only tracks that have one eddy in current date

* As soon as eddy leaves track, make it disappear.

* Draw a marker at the current date.

* Improve preemption timer on Windows systems

* Do not use negative degrees north and east.

Then simply take off all the buttons that currently don't work, and
then I'll be done.

Right now, memory fragmentation is a considerable problem in the
viewer, so I'll have to optimize it to be more memory conscious.

----------------------------------------

Serious repo cleanup work:

http://www.git-scm.com/book/ch9-7.html

"GUI improvements, advanced codebase, and JavaScript build infrastructure."

# Check the data size before:
git count-objects -v

git filter-branch --index-filter \
  'git rm --cached --ignore-unmatch -r blue_marble coolssh pngssh jpgssh docs/jsdocs' \
  -- 0889fbbe6c98db3a6d6de072f8eaf9485ee099b4^..
git remote rm origin
rm -Rf .git/refs/original
rm -Rf .git/logs/
git gc
git prune --expire now
git remote add origin https://mako0042@github.umn.edu/faghm001/EddyWebViewer.git
git push --force

# Check the data size after:
git count-objects -v

Then, for finally wiping out the contents of the remote, do this:
git push --force

For a safe push instead, do this:
git branch pruned
git push origin pruned

----------------------------------------

Need to include a short introduction for developers.  /Short/ is important.

Sphere sampling equation.  Divide up surface area evenly among the
points.

Eddy boundary finding.  Take the center point.  Extend one pixel
outward.  Trace convex boundary of pixels with same value.  If
successful, repeat.  You will get the largest boundary of the eddy.

Note: The JavaDocs currently don't automatically tell you what the
base class of classes and the types of objects are, so I'll have to
retrofit that information into the documentation comments manually.

I could just call it "View" instead of "Projection".

----------------------------------------

Things to go over at this current time:

* How's the video conversion status?

* About the daily data.  Is is about 7 times as large as the weekly
  data?  I don't have a copy of the daily data at the moment.

* The problem with only downloading the data at a specific point in
  time is caching.  XMLHttpRequests were not designed to efficiently
  work with large amounts of data, so there are a variety of problems
  when trying to use it for caching.  It might be the case that the
  browser doesn't do as good of a job at caching as it should do.
  Anyways, complicated caching logic needs to be implemented in
  JavaScript such that it will take quite a while to get a setup where
  only the needed data is downloaded.

* Also another problem with downloading the data at a specific point
  in time.  If only data at one point in time is downloaded, then
  there will be problems with tracks that are out of scope: tracks
  that are so long that they escape the cache size.  (This problem is
  particularly due to the storage of data keyed on tracks and using
  linked lists to assemble the tracks.)  For such a case, should only
  a red dot be drawn?

* I'm at the point where moving up to the daily data is doable, but
  doing so would introduce the same memory and download problems that
  was the case for the weekly data for the alpha viewer.  If this is
  okay, we can go with it.

* About the format of license notices... finishing steps.

* Public Github?

* About tracks rendering... the changes I will incorporate will
  provide some speedups, but not too many speedups.  I would have to
  move on to benchmarking multiple different mechanisms in browser,
  then choosing the fastest.  I won't have enough time for that,
  though.  Vector graphics is always more complicated and slower than
  raster graphics.  Raster graphics can convey a large amount of
  detail with very little computational overhead.  Vector graphics
  algorithms must be many times more complicated.  Land mass
  background is the way it is, in case you may not have been aware of
  it.

* (On the other hand, raster data is much larger in size.)

* Eddy boundaries.  For this, generate a monochrome image of the
  boundaries.

----------------------------------------

Icons TODO:

* Compass and calendar icons

Use a switch to control two modes of scrolling: pinned or
linear angle.

Test the most generic algorithm for tilt.

Rewrite Implementation Center to take the following form:

* Data Coversion and Export

* Overall Internal Code Architecture

* CSS User Interface

See the User Documentation for an overview of the new CSS
GUI.

Adding new projections?  Replace with d3?  In particular,
see this section.  d3 uses a conceptually incorrect model
for what it does, but the reason why... better performance
for some common projection calculations.

Why not: when.js: only designed for "promises", not
coroutines.

Strikedown of all popular JavaScript libraries.

Think about including a pre-MATLAB colored version of all SSH images
just to be nice.

----------------------------------------

Docs:

For every module:

* Problem: Solution, why this module exists.

* Basic usage example

* Document everything.  It's always nice to see that /everything/ has
  been covered comprehensively.  Everything.  Say that you must use
  TrigLUT as memoization.  Earth.nullschool.net used grid, but you
  must say it as that.  Conceptual framework.

* High-level framework.

* MapPol shift container: CSS shifting within box vs. draw to canvas.

Don't know if all variable caching is necessary.  Need to perform a
perf benchmark to decide.

Compute box edges and center.

Example functions are given in the base implementations.

Use return value checking in the examples.

Use requestAnimationFrame to request an arbitrary amount of time that
is appropriate for the browser.

Note: Many of the internal mathematics assume quadrant I as the
top-right, whereas many of the APIs assume top-left.

Flowchart to describe high-level modules.

Be careful about which Web API calls you make at the root document
level.  Better yet, wrap all root-level initializers into a special
startup function.  Maybe actually defer creating global objects until
it is known that they can be created safely.

The code is meant to be nearly identical to C/C++ syntax.

Minimize getContext() calls.
